<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Weather Map</title>
        <!-- My Personalized Stylesheet -->
        <link rel="stylesheet" href="/css/weather_map.css">
    </head>
    <body>
        <h1>Your Weather Source</h1>
        <h3 id="location">San Antonio</h3>
        <!-- div for forecast information -->
        <div id="latLong">
            <form>
                <input type="text" placeholder="Latitude" id="lat">
                <input type="text" placeholder="Longitude" id="lon">
            </form>
                <button type="submit" id="submit">Get Your Forecast</button>
        </div>
        <div id="forecast">
            
        </div>
        <div id="map-canvas">
            
        </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBazzMwgBg_qkFetM-tDCBbxrRMSuSEPNA"></script>
        <script>
        (function(){
        "use strict";
            // script to load OpenWeather API
            var defaultLat = 29.424933;
            var defaultLon = -98.488355;
            var defaultWeather = function(event){
                $.get("http://api.openweathermap.org/data/2.5/forecast/daily", {
                lat: defaultLat,
                lon: defaultLon,
                APPID: "0a5faae42ab05b77622877da6f519e86",
                units: "imperial"
                }).done (function(data){
                    // script to insert forecast data in the browser 
                    $('#forecast').html('');
                    for (var i = 0; i < data.list.length; i++) {
                        var div = $('<div>');
                        div.addClass('block');
                        $('#location').html('<h3>' + data.city.name + '</h3>');
                        div.append('<img src = "http://openweathermap.org/img/w/' + data.list[i].weather[0].icon + '.png">');
                        div.append('<p>' + data.list[i].weather[0].description + '</p>');
                        div.append('<p> Hi ' + parseInt(data.list[i].temp.max) + '</p>');
                        div.append('<p> Lo ' + parseInt(data.list[i].temp.min) + '</p>');
                        $('#forecast').append(div);
                    }
                    console.log(data);
                });
            };

            // script to load default weather forecast for San Antonio
            defaultWeather();

            // script to submit latitude and longitude to change forecast location
            $(document).on('click', '#submit', function(changeLocation){
                defaultLat = $('#lat').val();
                defaultLon = $('#lon').val();
    
                defaultWeather();  
            });

            // script to add Google map to page
            // Set our map options
            var mapOptions = {
            
            // Set the zoom level
            zoom: 10,

            // This sets the center of the map at our location
            center: {
                lat:  defaultLat,
                lng: defaultLon,
                }
            };

            // Render the map
            var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

            // script for the marker
            var marker = new google.maps.Marker({
            animation: google.maps.Animation.DROP,
            position: {
                lat: restaurant.lat,
                lng: restaurant.lng 
            }, 
            map: map
        });
        })();
        </script>
    </body>
</html>